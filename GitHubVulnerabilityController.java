package OSV.scanner.OSVscanner.controller;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

import OSV.scanner.OSVscanner.model.CommitVulnerabilityReport;
import OSV.scanner.OSVscanner.model.ScanRequest;
import OSV.scanner.OSVscanner.service.GitHubScannerService;

@RestController
@RequestMapping("/scan")
public class GitHubVulnerabilityController {
    @Autowired
    private GitHubScannerService gitHubScannerService;

    @PostMapping
    public ResponseEntity<CommitVulnerabilityReport> scanRepository(@RequestBody ScanRequest request) {
        CommitVulnerabilityReport report = gitHubScannerService.scanRepository(request.getRepoUrl());
        return ResponseEntity.ok(report);
    }
}
